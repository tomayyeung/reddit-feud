syntax = "proto3";

package devvit.ui.effects.v1alpha;

option go_package = "github.snooguts.net/reddit/reddit-devplatform-monorepo/go-common/generated/protos/types/devvit/ui/effects/v1alpha";
option java_package = "com.reddit.devvit.ui.effects.v1alpha";

enum OrderResultStatus {
  STATUS_CANCELLED = 0;
  STATUS_SUCCESS = 1;
  STATUS_ERROR = 2;
}

// Emitted by an app to request a purchase flow by the client
message CreateOrderEffect {
  // ID of this effect to route the OrderResultEvent to the correct handler
  string id = 1;
  // List of product SKUs the user intends to purchase
  repeated string skus = 2;
  // Optional metadata map
  map<string, string> metadata = 3;
}

// Sent to the app after the purchase attempt has concluded
message OrderResultEvent {
  // If failed, optional user-presentable error message
  optional string error_message = 2;
  // If successful, the order ID for the app to use to verify the purchase
  optional string order_id = 3;
  // The original request
  CreateOrderEffect order = 4;
  // Status
  OrderResultStatus status = 5;
  // If failed, optional error code
  optional int32 error_code = 6;

  reserved 1;
  reserved "success";
}
