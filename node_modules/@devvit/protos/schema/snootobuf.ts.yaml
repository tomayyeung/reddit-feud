#
# This is the snootobuf config to generate TypeScript files.
# It relies on proto dependencies from the main snootobuf.yaml.
# It's primarily executed by the gen-ts-protos.sh script.
#

dependencies:
  # This tells snootobuf to use dependencies from the main snootobuf.yaml file.
  - local_path: ./

plugins:
  - name: ts_proto_files
    # This is installed with a `yarn install` in the root of the monorepo.
    path: ../../../node_modules/.bin/protoc-gen-ts_proto
    options:
      - esModuleInterop=true
      - exportCommonSymbols=false
      - useOptionals=messages
      - metadataType=Metadata@./../lib/Types.js
      - outputServices=default
      - outputTypeAnnotations=static-only
      - outputTypeRegistry=no-tags
      - addGrpcMetadata=true
      - useExactTypes=false
      - outputServices=generic-definitions
      - useNumericEnumForJson=true
      - importSuffix=.js
    outputs:
      - into: ../src/types

  - name: twirp_files
    # This is installed with a `yarn install` in the root of the monorepo.
    path: ../../../node_modules/.bin/protoc-gen-twirp_ts
    options:
      - ts_proto,standalone
    outputs:
      - into: ../src/types

experimental:
  prototext_lock_file: true
